Code signing is a significant topic when it comes to initial access because they form part of the trust model for technologies like SmartScreen.  Files that have been signed by a trusted authority produce fewer (or zero) security alerts compared to those that haven't, and fewer alerts gives better odds that a victim will go through with executing a payload.  AV and EDR products may also look more favourably on signed files.  However, this isn't free from controversy depending on how a code-signing certificate is sourced.

There are two main types of code-signing certificate: "standard" and "EV" (Extended Validation).  A standard certificate doesn't do much other than to add a digital signature to your files, which is designed to assure users that they haven't been tampered with.  EV on the other hand, makes your publisher identity trusted by SmartScreen and completely removes all "Unknown Publisher" warnings.  Therefore, an EV code-signing certificate is really the one you want.

![](https://lwfiles.mycourse.app/66e95234fe489daea7060790-public/24718ae6b8d988851e621722fbc7ccb8.png)The official way to obtain an EV code-signing certificate is to go and buy one from an authority like DigiCert or GlobalSign.  Although the specifics will vary between authorities, they require that a business undergoes a vetting process before a certificate will be issued.  This isn't really an issue for a legitimate businesses, but is often a road-block for individuals and consultants.  However, this isn't something you want to be doing anyway.  First off, you don't want to sign your initial access malware with your "MyRedTeamCompany" certificate because a) it's a bit obvious to the victim, and b) if the malware is uploaded to somewhere like VirusTotal, your certificate will likely get revoked.

This is where the controversies creep in.  If it's not feasible to buy a certificate as your company, what else can you do?  One possibility is to set up and maintain dummy/shell companies, which takes a lot of time and effort.  Another is to use leaked and/or stolen certificates, which is much quicker and easier.  For instance, GitHub has a path qualifier that can be used to find certificates that have been committed to public repositories.  You may also search public S3 buckets, game hacking forums, and other places.

Regardless of where you land on the legal/ethical/moral spectrum, this is a threat that should be modelled if initial access is part of your engagement.  Threat actors are using this tactic in their campaigns, so defenders do need to develop strategies against it.