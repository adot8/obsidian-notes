
![[Pasted image 20251025134742.png]]

#### EXEs

EXE files are standalone executable files that contain the complete code and resources required to run an application independently. When you run an EXE file, it starts a new process and executes the program it contains.

> EXEs are separate programs that can be loaded into memory as an independent process

At least in C, the `main()` function will be executed after the initialisation process of the executable is completed by the OS loader.

#### DLLs

DLL files, are libraries that contain reusable code and resources that multiple applications can use simultaneously. They are designed to be loaded and executed by multiple processes, allowing various programs to share the same functionality without duplicating code.

> Dynamic Link Libraries (DLLs) are PEs that are loaded into existing processes and cannot live independently in memory. Their main purpose is to deliver functionality to a calling processes needs (ex: performs cryptographic functionalities; or provides extra GUI functionality)

For execution of the DLL, the OS loader has already created a process in memory, when the process needs the DLL for some sort of functionality the loader reads the DLL from disk, reserves space in the target process and loads the function into the space.

The  DLL `main function` is then called by the loader, initialising the library, then finally the loader hands over control to the process to call the needed function.

> When malware is created as a DLL, the DLL `main function `needs to be created and at least one function needs to be exported that can be called externally


---

#### Source Code vs Compiled Code

A **_C compiler_** is a software tool that translates human-readable C programming code into machine-readable binary code, which can be executed by a CPU. The compiler generates _object files_, which are not executable images yet. They need to be reformatted and this is the job of **_a linker_**. Its purpose is to link these object files together, along with any necessary libraries, to produce the final executable file (PE file in the case of Windows).

The process of compilation and linking involves several stages:

1. **Lexical Analysis**: The compiler first performs lexical analysis or scanning, where it reads the C source code character by character and groups them into tokens (keywords, identifiers, operators, etc.).
    
2. **Syntax Analysis (Parsing)**: The compiler then performs syntax analysis or parsing, where it organizes the tokens into a syntax tree based on the rules of the C language's grammar. This process ensures that the code follows the correct structure and syntax.
    
3. **Semantic Analysis**: After parsing, the compiler checks for semantic correctness. It verifies that variables are declared before use, types are compatible, and functions are called with the correct number and type of arguments.
    
4. **Intermediate Code Generation**: At this stage, the compiler creates intermediate code or an intermediate representation (IR) of the program. The intermediate code is typically platform-independent and allows for easier optimizations.
    
5. **Optimization**: The compiler may perform various optimization techniques on the intermediate code to improve the efficiency of the generated code. These optimizations aim to reduce the size of the resulting executable, improve execution speed, and optimize memory usage.
    
6. **Code Generation**: The compiler now generates the machine code specific to the target platform (in this case, Windows). It maps the intermediate code to actual assembly language instructions suitable for the target processor architecture.
    
7. **Embedding Resources**: Apart from code and data, a PE file can also include resources such as icons, bitmaps, version information, and other data. These resources are typically embedded within the .rsrc section of the PE file.
    
8. **Linking**: A C program may consist of multiple source files and libraries. The linker is responsible for combining all the compiled object files and resolving external references between them. It creates a single executable PE file that contains all the necessary information to run the program.
    

Once the PE file is generated, you can run the executable on a compatible Windows system, and it will execute the program according to the instructions provided in the original C source code.