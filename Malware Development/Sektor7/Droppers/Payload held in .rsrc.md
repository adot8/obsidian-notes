

#### Retrieving payload from .rsrc algorithm (C-like pseudo-code)

```c
// 1. find the resource in .rsrc section containing payload 
res = FindResource(NULL, MAKEINTRESOURCE(FAVICON_ICO), RT_RCDATA)

// 2. load the resource from .rsrc section
resHandle = LoadResource(NULL, res)

// 3. get a pointer to the loaded resource
payload = (char *) LockResource(resHandle);

// 4. get the size of the resource/payload
payload_len = SizeofResource(NULL, res)
```
#### Compiling

```powershell
rc.exe resources.rc
cvtres.exe /MACHINE:x64 /OUT:resources.o resources.res
cl.exe /nologo /Ox /MT /W0 /GS- /DNDEBUG /Tcimplant.cpp /link /OUT:implant.exe /SUBSYSTEM:CONSOLE /MACHINE:x64 resources.o
```

In Windows, `rc.exe` and `cvtres.exe` are two command-line tools used in the process of building Windows applications. They are part of the Microsoft Visual Studio toolset.

1. [**_Resource Compiler_**](https://learn.microsoft.com/en-us/windows/win32/menurc/resource-compiler): `rc.exe` is a special resource compiler in Windows. It is used to compile resource script files (with a _.rc_ extension) into binary resource files (with a _.res_ extension). Resource script files contain resources such as icons, bitmaps, dialog boxes, menus, strings, version information, etc., that are used in Windows applications.
    
2. **_Resource Converter_**: `cvtres.exe` is used to convert resource files from an older format (usually _.res_ files) to the newer _.coff_ format (Microsoft's Common Object File). This conversion is necessary for compatibility with modern development tools and linkers. `cvtres.exe` is typically invoked during the build process after resource files are compiled with `rc.exe`.