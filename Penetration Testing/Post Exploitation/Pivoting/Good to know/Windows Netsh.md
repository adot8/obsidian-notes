[Netsh](https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-contexts) is a Windows command-line tool that can help with the network configuration of a particular Windows system. Here are just some of the networking related tasks we can use `Netsh` for:

- `Finding routes`
- `Viewing the firewall configuration`
- `Adding proxies`
- `Creating port forwarding rules`

### Scenario
![[Pasted image 20250124062629.png]]
We can use `netsh.exe` to forward all data received on a specific port (say 8080) to a remote host on a remote port. This can be performed using the below command
```powershell
netsh advfirewall firewall add rule name="Chisel" dir=in action=allow protocol=tcp localport=54321

netsh.exe interface portproxy add v4tov4 listenport=8080 listenaddress=10.10.14.189 connectport=3389 connectaddress=172.16.5.19
```
Verify configuration
```powershell
netsh.exe interface portproxy show v4tov4
```